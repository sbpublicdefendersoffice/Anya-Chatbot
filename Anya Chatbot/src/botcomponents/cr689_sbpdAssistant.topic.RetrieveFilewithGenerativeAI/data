kind: AdaptiveDialog
modelDescription: "This tool can handle queries like these: retrieve file, get file, fetch document, access file, obtain document"
beginDialog:
  kind: OnRecognizedIntent
  id: main
  intent:
    triggerQueries:
      - retrieve file
      - get file
      - fetch document
      - access file through
      - obtain document
      - retrieve information using generative algorithms
      - get data with the help of AI generation
      - fetch content through generative intelligence

  actions:
    - kind: Question
      id: Question_OBr224
      variable: Topic.SearchQuery
      prompt: Sure! What would you like to find?
      entity: StringPrebuiltEntity

    - kind: SendActivity
      id: sendActivity_aUJcDp
      activity: |-
        Give me a moment to look through SharePoint...
        
        _This may take a moment, as the response is being generated by a language model_

    - kind: SearchAndSummarizeContent
      id: hOwatV
      userInput: =Topic.SearchQuery
      moderationLevel: Medium
      additionalInstructions: Make summaries of files short, only a brief sentence per file found. Keep sentences to under 30 words each (not counting the length of the file name), where each sentence describes the content of the file and provide's the name of the file.
      fileSearchDataSource:
        searchFilesMode:
          kind: DoNotSearchFiles

      knowledgeSources:
        kind: SearchSpecificKnowledgeSources
        knowledgeSources:
          - cr689_sbpdAssistant.knowledge.SantaBarbaraPublicDefendersOfficeSharepoint_kXeaQIGgiWignZNCzNT1p

      responseCaptureType: FullResponse

    - kind: Question
      id: question_9TeAHu
      interruptionPolicy:
        allowInterruption: true

      variable: init:Topic.Var1
      prompt: Are you looking for something else?
      entity: BooleanPrebuiltEntity

    - kind: ConditionGroup
      id: conditionGroup_LRUlqc
      conditions:
        - id: conditionItem_VryNol
          condition: =Topic.Var1 = true
          actions:
            - kind: GotoAction
              id: 7nKK3n
              actionId: Question_OBr224

      elseActions:
        - kind: SendActivity
          id: sendActivity_nKNt4h
          activity: Great. Let me know if you need anything.

    - kind: BeginDialog
      id: 1adZM8
      dialog: cr689_sbpdAssistant.topic.ConversationStart